#!/bin/sh
set -eu

base="/home/sandbox/workspace"

for arg in "$@"; do
  case "$arg" in
    -*) continue ;; 
    /*)
      case "$arg" in
        "$base"|"$base"/*|"/workspace"|"/workspace"/*) ;; 
        *) echo "ls: access denied" >&2; exit 1 ;;
      esac
      ;;
    *".."*) echo "ls: access denied" >&2; exit 1 ;;
  esac
  break
 done

exec /bin/ls "$@"
